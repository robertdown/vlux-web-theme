{{- $csp := .Site.Params.csp | default (dict "script" (slice) "style" (slice) "font" (slice) "img" (slice) "connect" (slice) "object" (slice) "base" (slice)) -}}
{{- if gt (len $csp) 0 -}}
  {{- $parts := slice -}}
  {{- range $k, $v := $csp -}}
    {{- $sources := delimit $v " " -}}
    {{- $parts = $parts | append (print $k "-src 'self' " $sources ";") -}}
  {{- end -}}
  <meta http-equiv="Content-Security-Policy" content="{{ delimit $parts " " }}">
{{- else -}}
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; font-src 'self' data:; img-src 'self' data:; connect-src 'self'; object-src 'self'; base-uri 'self'; frame-ancestors 'self';">
{{- end -}}
